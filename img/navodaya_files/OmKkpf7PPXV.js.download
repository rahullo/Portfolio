if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("XAppGrowthCtaLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/android/redirect/cta_logging/",{event:{type:"Enum",required:!0,enumType:1}})}),null);
__d("MAppGrowthCtaLogging",["BanzaiLogger","Stratcom","XAppGrowthCtaLoggingController","XAsyncRequest","goURI"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("Stratcom").listen("click",a,function(a){var b=a.getTarget().getAttribute("data-disabled");a.getTarget().setAttribute("data-disabled","1");var d=a.getTarget().getAttribute("href");if(b!="1"){b=a.getTarget().getAttribute("data-event");b=c("XAppGrowthCtaLoggingController").getURIBuilder().setEnum("event",b).getURI();var e=function(b){a.getTarget().setAttribute("data-disabled","")};new(c("XAsyncRequest"))(b).setMethod("POST").setHandler(e).send()}b=d.startsWith("#!")?d.substring(2):d;c("goURI")(b)})}function b(a,b,d,e,f){c("Stratcom").listen("click",a,function(a){c("BanzaiLogger").log("MsiteUpsellPromosRealTimeLoggerConfig",{event:"clicked",upsell:b,impression:d});e!==""&&c("goURI")(e);a=a.getTarget().getAttribute("href");a=a.startsWith("#!")?a.substring(2):a;c("goURI")(a)})}g.init=a;g.logToPromoFunnelLogger=b}),98);
__d("XTaggingCounterController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/composer/tagging/counter/",{event:{type:"Enum",required:!0,enumType:1}})}),null);
__d("MTaggingCounter",["AsyncSignal","XTaggingCounterController"],(function(a,b,c,d,e,f){a={logEvent:function(a,c){c=b("XTaggingCounterController").getURIBuilder().setEnum("event",a).getURI();new(b("AsyncSignal"))(c).send()}};e.exports=a}),null);
__d("MFeedAttributionOnClick",["Event"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("Event").listen(a,"click",function(){})}function b(a){c("Event").listen(a,"click",function(){})}g.logExposureOnFb4aAttributionClick=a;g.logExposureOnFbliteAttributionClick=b}),98);
__d("MLtgTranslationPreferencesBootloader",["Bootloader","EventListener"],(function(a,b,c,d,e,f,g){var h;function a(a,e,f,g,i){c("EventListener").listen(a,"click",function(){c("Bootloader").loadModules(["React","ReactDOM","DOMContainer.react","MLtgTranslationPreferences.react"],function(c,j,k,l){b=c,d=j,h||d.render(b.jsx(l,{translationData:f,originalMessageElem:g,showDropdown:!0,mLanguageSettingsURI:i,children:b.jsx(k,{children:e})}),a)},"MLtgTranslationPreferencesBootloader")})}g.bootloadDropdown=a}),98);
__d("ViewableImpressionUtils",[],(function(a,b,c,d,e,f){a={isHorizontallyOffscreen:function(a,b,c){a=Math.max(b.x,0);c=Math.min(b.x+b.width,c.width);return c-a<b.width}};e.exports=a}),null);
__d("MsiteFullViewFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1962677");c=b("FalcoLoggerInternal").create("msite_full_view",a);e.exports=c}),null);
__d("FullViewLogger",["Banzai","MsiteFullViewFalcoEvent","ScriptPath","SubscriptionsHandler","URI","killswitch","uuid"],(function(a,b,c,d,e,f,g){a=function(){function a(){}a.logFromViewableImpressionTracker=function(b){var c=new a();c.subscribeToTrackerEvents(b)};var b=a.prototype;b.subscribeToTrackerEvents=function(a){this.$1=new(c("SubscriptionsHandler"))(),this.$1.addSubscriptions(a.addListener("full_view",this.onFullView.bind(this)))};b.onFullView=function(a){this.$2()&&this.$3(a);var b=c("uuid")(),d={token:a.token,fullViewType:a.fullViewType,scriptPath:c("ScriptPath").getTopViewEndpoint(),eventTraceID:b};c("Banzai").post("xtrackable:full_view",d);c("killswitch")("MSITE_STOP_FULLVIEW_LOGGING_VIA_FALCO")||c("MsiteFullViewFalcoEvent").log(function(){return d});this.$2()&&this.$4(d)};b.$2=function(){return 0};b.$3=function(a){};b.$4=function(a){};return a}();g["default"]=a}),98);
__d("MsiteViewabilityFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1958033");c=b("FalcoLoggerInternal").create("msite_viewability",a);e.exports=c}),null);
__d("PercentVisible",[],(function(a,b,c,d,e,f){a=-1;b=0;c=50;d=100;f.NO_VISIBLE=a;f.VISIBLE_0_PCT=b;f.VISIBLE_50_PCT=c;f.VISIBLE_100_PCT=d}),66);
__d("ViewabilityDurationSegmentLogger",["Banzai","MsiteViewabilityFalcoEvent","PercentVisible","killswitch","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h=8e3;a=function(){a.logFromViewableImpressionTracker=function(b){var c=new a();c.subscribeToTrackerEvents(b)};function a(){this.$1=new Map(),this.$2=new Map(),this.$3=new Map(),this.$4=new Map(),this.$5=new Map()}var b=a.prototype;b.subscribeToTrackerEvents=function(a){a.addListener("viewability",this.onViewable.bind(this)),a.addListener("viewport_viewability",this.onViewport.bind(this)),a.addListener("hidden",this.onHidden.bind(this))};b.onViewable=function(a){var b=a.id,c=a.percentVisible,e=Date.now(),f;switch(c){case d("PercentVisible").VISIBLE_0_PCT:c=this.$1.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_0_PCT,e,"feed_unit"):this.$7(c,b,e);c=this.$2.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));c=this.$4.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));break;case d("PercentVisible").VISIBLE_50_PCT:c=this.$1.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_0_PCT,e,"feed_unit"):this.$7(c,b,e);c=this.$2.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_50_PCT,e,"feed_unit"):this.$7(c,b,e);c=this.$4.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));break;case d("PercentVisible").VISIBLE_100_PCT:c=this.$1.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_0_PCT,e,"feed_unit"):this.$7(c,b,e);c=this.$2.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_50_PCT,e,"feed_unit"):this.$7(c,b,e);c=this.$4.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_100_PCT,e,"feed_unit"):this.$7(c,b,e);break}};b.onViewport=function(a){var b=a.id,c=a.percentVisible,e=Date.now(),f;switch(c){case d("PercentVisible").VISIBLE_0_PCT:c=this.$3.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));c=this.$5.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));break;case d("PercentVisible").VISIBLE_50_PCT:c=this.$3.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_50_PCT,e,"viewport"):this.$7(c,b,e);c=this.$5.get(b);c&&(f=this.$8(c,b,e,!0),this.$9(f,b));break;case d("PercentVisible").VISIBLE_100_PCT:c=this.$3.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_50_PCT,e,"viewport"):this.$7(c,b,e);c=this.$5.get(b);!c?this.$6(a,d("PercentVisible").VISIBLE_100_PCT,e,"viewport"):this.$7(c,b,e);break}};b.onHidden=function(a){a=a.id;var b=Date.now(),c=this.$1.get(a),d=this.$2.get(a),e=this.$3.get(a),f=this.$4.get(a),g=this.$5.get(a);c&&this.$9(this.$8(c,a,b,!0),a);d&&this.$9(this.$8(d,a,b,!0),a);e&&this.$9(this.$8(e,a,b,!0),a);f&&this.$9(this.$8(f,a,b,!0),a);g&&this.$9(this.$8(g,a,b,!0),a)};b.$6=function(a,b,c,e){c={token:a.token,startedTrackingTS:c,percentVisible:b,visibilityUnit:e,intervalMs:0,cumulativeMs:0,segmentIdx:0,eventTraceID:""};switch(b){case d("PercentVisible").VISIBLE_0_PCT:this.$1.set(a.id,c);break;case d("PercentVisible").VISIBLE_50_PCT:e==="feed_unit"?this.$2.set(a.id,c):this.$3.set(a.id,c);break;case d("PercentVisible").VISIBLE_100_PCT:e==="feed_unit"?this.$4.set(a.id,c):this.$5.set(a.id,c);break}};b.$8=function(a,b,c,e){c=c-a.startedTrackingTS;var f=c-a.cumulativeMs,g=a.percentVisible;f={token:a.token,startedTrackingTS:a.startedTrackingTS,percentVisible:g,visibilityUnit:a.visibilityUnit,intervalMs:f,cumulativeMs:c,segmentIdx:++a.segmentIdx,eventTraceID:""};e&&(f.duration=c);switch(g){case d("PercentVisible").VISIBLE_0_PCT:this.$1.set(b,f);break;case d("PercentVisible").VISIBLE_50_PCT:a.visibilityUnit==="feed_unit"?this.$2.set(b,f):this.$3.set(b,f);break;case d("PercentVisible").VISIBLE_100_PCT:a.visibilityUnit==="feed_unit"?this.$4.set(b,f):this.$5.set(b,f);break}return f};b.$7=function(a,b,d){var e=this,f=a.intervalMs,g=d-a.startedTrackingTS-a.cumulativeMs;if(this.$10(f,g)){var h=this.$8(a,b,d,!1);f=c("uuid")();h.eventTraceID=f;c("Banzai").post("xtrackable:viewability",h,c("Banzai").VITAL);c("killswitch")("MSITE_STOP_VIEWABILITY_LOGGING_VIA_FALCO")||c("MsiteViewabilityFalcoEvent").logImmediately(function(){return e.$11(h)})}};b.$10=function(a,b){if(a>=h)return!1;if(a==0)return!0;if(a<1e3)return b>=1e3;a=a/1e3;b=b/1e3;return b>=2*a};b.$9=function(a,b){var e=this,f=a.percentVisible;switch(f){case d("PercentVisible").VISIBLE_0_PCT:this.$1["delete"](b);break;case d("PercentVisible").VISIBLE_50_PCT:a.visibilityUnit==="feed_unit"?this.$2["delete"](b):this.$3["delete"](b);break;case d("PercentVisible").VISIBLE_100_PCT:a.visibilityUnit==="feed_unit"?this.$4["delete"](b):this.$5["delete"](b);break}f=c("uuid")();a.eventTraceID=f;c("Banzai").post("xtrackable:viewability",a,c("Banzai").VITAL);c("killswitch")("MSITE_STOP_VIEWABILITY_LOGGING_VIA_FALCO")||c("MsiteViewabilityFalcoEvent").logImmediately(function(){return e.$11(a)})};b.$11=function(a){return{token:a.token,startedTrackingTS:a.startedTrackingTS.toString(),segmentIdx:a.segmentIdx.toString(),percentVisible:a.percentVisible.toString(),visibilityUnit:a.visibilityUnit,intervalMs:a.intervalMs.toString(),cumulativeMs:a.cumulativeMs.toString(),eventTraceID:a.eventTraceID,duration:(a=a.duration)==null?void 0:a.toString()}};return a}();g["default"]=a}),98);
__d("ViewableImpressionDurationLogger",["Banzai"],(function(a,b,c,d,e,f,g){"use strict";a=function(){a.logFromViewableImpressionTracker=function(b){var c=new a();c.subscribeToTrackerEvents(b)};function a(){this.$1=new Map()}var b=a.prototype;b.subscribeToTrackerEvents=function(a){a.addListener("visible",this.onElementVisible.bind(this)),a.addListener("hidden",this.onElementHidden.bind(this))};b.onElementVisible=function(a){if(this.$1.get(a.id))return null;var b={token:a.token,startedTrackingTS:this.getTimeNow()};this.$1.set(a.id,b);return b};b.onElementHidden=function(a){var b=this.$1.get(a.id);if(!b)return!1;b.trackingDuration=this.getTimeNow()-b.startedTrackingTS;return this.sendLog(a.id)};b.sendLog=function(a){var b=this.$1.get(a);if(!b||!b.trackingDuration)return!1;c("Banzai").post("xtrackable:duration",b);this.$1["delete"](a);return!0};b.getTimeNow=function(){return parseFloat((Date.now()/1e3).toFixed(2))};return a}();g["default"]=a}),98);
__d("ViewableImpressionHeatmapLogger",["Banzai"],(function(a,b,c,d,e,f,g){a=function(){a.logFromViewableImpressionTracker=function(b,c){c=new a(c);c.subscribeToTrackerEvents(b)};function a(a){this.$1=a,this.$2=new Map()}var b=a.prototype;b.subscribeToTrackerEvents=function(a){a.addListener("visible",this.onElementVisible.bind(this)),a.addListener("hidden",this.onElementHidden.bind(this))};b.onElementVisible=function(a){var b=this.getCurrentTimestamp(),c=this.$2[a.id];c||(c=this.createTrackingEntry(a),this.beginTracking(a.id,c),b=c.startedTrackingTS);c.viewportProgressEvents.push({timestamp:b,percentInViewport:a.percentInViewport.toFixed(2)})};b.onElementHidden=function(a){var b=this.getCurrentTimestamp();a=this.$2[a.id];if(!a)return;a.viewportProgressEvents.push({timestamp:b,percentInViewport:0})};b.onTrackingCompleted=function(a){var b=this.$2.get(a);if(!b)return;b.viewportProgressEvents.push({timestamp:this.getCurrentTimestamp(),percentInViewport:b.tracker.getPercentInViewport().toFixed(2)});this.$3()&&this.$4(a,b);this.logToServer(b);this.$2["delete"](a)};b.logToServer=function(a){a=a;delete a.tracker;c("Banzai").post("xtrackable:heatmap",a)};b.beginTracking=function(a,b){var c=this;this.$2.set(a,b);setTimeout(function(){return c.onTrackingCompleted(a)},this.$1)};b.createTrackingEntry=function(a){return{tracker:a.tracker,token:a.token,startedTrackingTS:this.getCurrentTimestamp(),viewportProgressEvents:[]}};b.getCurrentTimestamp=function(){return(Date.now()/1e3).toFixed(2)};b.$3=function(){return 0};b.$4=function(a,b){var c="Completed tracking for id "+a+" token="+b.token+" startedTrackingTS="+b.startedTrackingTS+"\n";b.viewportProgressEvents.forEach(function(a){c+="% in view: "+a.percentInViewport+" timestamp="+a.timestamp+"\n"})};return a}();g["default"]=a}),98);
__d("BrowseClientEventLogger",[],(function(a,b,c,d,e,f){"use strict";a={maybeLogClientViewEvent:function(a){},maybeLogVisiblityEvent:function(a){}};e.exports=a}),null);
__d("CometMetricsChannel2ViewabilityFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1960868");c=b("FalcoLoggerInternal").create("comet_metrics_channel2_viewability",a);e.exports=c}),null);
__d("FBFeedImpressionTopMarginGetter",["getElementPosition","getStyleProperty"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function i(){try{if(h==null)return 0;var a=c("getStyleProperty")(h,"position");if(a==="fixed"){a=c("getElementPosition")(h);return a.height>0?Math.max(0,a.y+a.height):0}return 0}catch(a){return 0}}function j(){try{var a=document.getElementById("bluebarRoot");if(a==null)return 0;a=a.firstChild;if(a==null)return 0;a=c("getElementPosition")(a);return Math.max(0,a.y+a.height)}catch(a){return 0}}function a(a){h=a}function b(){var a=j(),b=i();return Math.max(a,b)}g.setActionBar=a;g.getTopMargin=b}),98);
__d("FBImpressionValidationUtils",["DataAttributeUtils"],(function(a,b,c,d,e,f){"use strict";a={getFBFeedLocation:function(a){try{a=JSON.parse(b("DataAttributeUtils").getDataFt(a));return a?a.fbfeed_location:null}catch(a){return null}}};e.exports=a}),null);
__d("FeedAdXoutEventTracker",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set();function a(a){c("gkx")("983221")&&h.add(a)}function b(a){c("gkx")("983221")&&h["delete"](a)}function d(a){return c("gkx")("983221")?h.has(a):!1}g.markHidden=a;g.undoHidden=b;g.checkIfHidden=d}),98);
__d("GHLDelay",["AdImpressionLoggingConfig"],(function(a,b,c,d,e,f){var g=null;a={getEnabled:function(){return g===null?b("AdImpressionLoggingConfig").enableDelayedHiddenCheck:g},setEnabled:function(a){g=a}};e.exports=a}),null);
__d("MsiteViewableImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1953926");c=b("FalcoLoggerInternal").create("msite_viewable_impression",a);e.exports=c}),null);
__d("NonBlockingIFrame",["DOM","Promise","TimeSlice"],(function(a,b,c,d,e,f){var g={},h,i;function j(a,c){a===void 0&&(a=g);c===void 0&&(c=document.body);var d={className:"nonBlockingIframe",width:0,height:0,frameborder:0,scrolling:"no","aria-hidden":"true"};a!==g&&(d.src=a);d=b("DOM").create("iframe",d);d.style.left="-1000px";d.style.position="absolute";b("DOM").appendContent(c,d);a===g&&(d.contentDocument.open(),d.contentDocument.close());return d}function k(){return new(b("Promise"))(function(a){h||(h=j()),h.contentDocument.readyState==="complete"?a(h):(i||(i=new(b("Promise"))(function(a){h.contentWindow.onload=b("TimeSlice").guard(function(){a(h)},"NonBlockingIFrame window.onload")})),a(i))})}a={loadImage:function(a){return k().then(function(c){return new(b("Promise"))(function(d,e){var f=c.contentWindow.Image,g=new f();g.onload=b("TimeSlice").guard(function(){d(g)},"NonBlockingIFrame image.onload");g.onerror=b("TimeSlice").guard(function(){e(g)},"NonBlockingIFrame image.onerror");g.onabort=b("TimeSlice").guard(function(){e(g)},"NonBlockingIFrame image.onabort");g.src=a})})},loadIFrame:function(a){a===void 0&&(a=g);return k().then(function(b){b=b.contentDocument.body;return j(a,b)})}};e.exports=a}),null);
__d("ViewabilityFramework",[],(function(a,b,c,d,e,f){a=Object.freeze({VIEWABLE_TRACKER_BLUE:"current_blue",VIEWABLE_TRACKER_BLUE_RHC:"current_blue_rhc",VIEWABLE_TRACKER_BLUE_EXIT:"current_blue_exit",VIEWABLE_TRACKER_BLUE_AFTER_DEDUP:"current_blue_after_dedup",IMPRESSION_API_COMET_ENTER:"impression_api_comet_enter",IMPRESSION_API_COMET_EXIT:"impression_api_comet_exit",IMPRESSION_API_COMET_AFTER_DEDUP:"impression_api_comet_after_dedup",IMPRESSION_API_COMET_AFTER_DEDUP_ORIGINAL:"impression_api_comet_after_dedup_original",INTERSECTION_OBSERVER_BLUE:"intersection_observer_blue",INTERSECTION_OBSERVER_BLUE_RHC:"intersection_observer_blue_rhc",INTERSECTION_OBSERVER_BLUE_EXIT:"intersection_observer_blue_exit",INTERSECTION_OBSERVER_BLUE_AFTER_DEDUP:"intersection_observer_blue_after_dedup",SCROLL_BASED_BLUE:"scroll_based_blue",SCROLL_BASED_BLUE_RHC:"scroll_based_blue_rhc",SCROLL_COMET:"scroll_comet",SCROLL_COMET_AFTER_DEDUP:"scroll_comet_after_dedup",SCROLL_COMET_EXIT:"scroll_comet_exit",AD_UNIT_GENERIC_API_COMET:"ad_unit_generic_api_comet",AD_UNIT_GENERIC_API_COMET_EXIT:"ad_unit_generic_api_comet_exit",AD_UNIT_GENERIC_API_COMET_AFTER_DEDUP:"ad_unit_generic_api_comet_after_dedup",AD_UNIT_SCROLL_COMET:"ad_unit_scroll_comet",AD_UNIT_SCROLL_COMET_EXIT:"ad_unit_scroll_comet_exit",AD_UNIT_SCROLL_COMET_AFTER_DEDUP:"ad_unit_scroll_comet_after_dedup",COMET_FULL_VIEW:"comet_full_view"});f["default"]=a}),66);
__d("ViewableSessionStore",[],(function(a,b,c,d,e,f){function a(a,b){}f.onEventLogged=a}),66);
__d("getCentralImpressionTimeAfterRefresh",[],(function(a,b,c,d,e,f){"use strict";var g=null;window.addEventListener("load",function(){g=Date.now()},{passive:!0});function a(){return g!=null?Date.now()-g:0}f["default"]=a}),66);
__d("isImpressionTargetOccluded",["containsNode","getViewportDimensions"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){d===void 0&&(d={bottom:0,left:0,right:0,top:0});try{if(!a||!b||!document.elementFromPoint)return!1;var e=c("getViewportDimensions")();if(e.height===0||e.width===0)return!1;var f=b.x,g=b.y,h=b.width;b=b.height;h=Math.min(f+h,e.width-1);b=Math.min(g+b,e.height-1);e=[{x:f,y:g},{x:f,y:b},{x:h,y:g},{x:h,y:b},{x:(f+h)/2,y:(g+b)/2}];d.top!==0&&d.top>g&&d.top<b&&e.push({x:(f+h)/2,y:(d.top+b)/2});return e.every(function(b){b=document.elementFromPoint(b.x,b.y);b=!!b&&!c("containsNode")(b,a)&&!c("containsNode")(a,b);return b})}catch(a){return!1}}g["default"]=a}),98);
__d("ViewableImpressionTracker",["csx","cx","AdImpressionLoggingConfig","Banzai","BrowseClientEventLogger","CometMetricsChannel2ViewabilityFalcoEvent","DOM","DataAttributeUtils","FBFeedImpressionTopMarginGetter","FBImpressionValidationUtils","FeedAdXoutEventTracker","GHLDelay","GHLTestElement","MsiteViewableImpressionFalcoEvent","NonBlockingIFrame","ODS","PercentVisible","Run","ScriptPath","Style","URI","ViewabilityFramework","ViewableImpressionUtils","ViewableSessionStore","Visibility","WebSession","WebStorage","cr:1095627","cr:1095628","ge","getCentralImpressionTimeAfterRefresh","getElementPosition","getViewportDimensions","ghlTestUBT","gkx","isImpressionTargetOccluded","killswitch","mixInEventEmitter","randomInt","uuid"],(function(a,b,c,d,e,f,g,h,i){var j=null,k=c("WebStorage").getLocalStorage(),l="imp_seq_num";a=function(){function a(a,b,e){var f=this;this.checkAndLogImpressionIfPendingOnExit=function(){c("AdImpressionLoggingConfig").enableFlushDelayLogOnCleanup&&f.waitForDelayLogged&&(clearTimeout(f.delayedLoggingTimeout),f.delayLogImpression())};this.delayLogImpression=function(){f.waitForDelayLogged=!1;var a="other";f.element.id.startsWith("hyperfeed")&&(a="16");a=c("GHLTestElement").testElementI(f.element,".vit."+a);if(a){f.$14();c("AdImpressionLoggingConfig").logForHiddenAds&&f.logImpression(1,!0,{});return}f.logImpression(1,!1,{});f.$12()};this.id=a;this.element=b;this.config=e;this.iframe=null;this.viewableTimeout=null;this.delayedLoggingTimeout=null;this.clearSubsequentTimeout=null;this.waitForSubsequent=!1;this.waitForLogged=!1;this.waitForDelayLogged=!1;this.isNonViewableLogged=!1;this.isVisible=!1;this.iframeLogged=!1;this.banzaiLogged=!1;this.falcoLogged=!1;this.topLeftInViewport=!1;this.bottomRightInViewport=!1;this.isHidden=!0;this.lastInvisibleReason=null;this.isSubsequentImp=!1;this.lastHiddenCause="none";this.lastImpressedAt=null;this.lastEnterWithPercent=null;d("Run").onUnload(this.checkAndLogImpressionIfPendingOnExit);d("Run").onLeave(this.checkAndLogImpressionIfPendingOnExit);c("ghlTestUBT")(function(a){a===!0&&c("GHLDelay").setEnabled(!0)})}var e=a.prototype;e.getID=function(){return this.id};e.getConfig=function(){return this.config};e.getPercentInViewport=function(){var a=c("getViewportDimensions")(),b=c("getElementPosition")(this.element);return this.$1(a,b)};e.$2=function(a,b,d,e){d===void 0&&(d=0);e===void 0&&(e=!1);var f={target_rect:b,root:{x:0,y:d,height:a.height-d,width:a.width}};if(b.height===0||b.width===0)return{rects:f,percentage:0,invisibleReason:"TARGET_SIZE_0"};var g=c("Style").get(this.element,"visibility")==="hidden",h=c("Style").get(this.element,"opacity")==="0";if(b.x<a.width&&b.x+b.width>0&&b.y<a.height&&b.y+b.height>d&&!g&&!h){var i=Math.max(b.x,0),j=Math.min(b.x+b.width,a.width);d=Math.max(b.y,d);a=Math.min(b.y+b.height,a.height);if(b.height*b.width===0)return{rects:f,percentage:100,invisibleReason:null};b=100*(j-i)*(a-d)/(b.height*b.width);var k=!1;if(b>0&&(e||this.config.should_not_log_on_occlusion)){k=c("isImpressionTargetOccluded")(this.element,{x:i,y:d,width:j-i,height:a-d});if(this.config.should_not_log_on_occlusion&&k)return{rects:f,percentage:0,invisibleReason:"IS_OCCLUDED"}}return{rects:f,percentage:b,invisibleReason:b>0?null:"NOT_IN_VIEWPORT",isOccluded:k}}return{rects:f,percentage:0,invisibleReason:g?"TARGET_HIDDEN":h?"TARGET_TRANSPARENT":"NOT_IN_VIEWPORT"}};e.$3=function(a,b,c){c===void 0&&(c=0);return this.$2(a,b,c).percentage};e.$4=function(a,b,d,e){d===void 0&&(d=0);e===void 0&&(e=!1);return this.config.require_horizontally_onscreen&&c("ViewableImpressionUtils").isHorizontallyOffscreen(this.element,b,a)?{rects:{target_rect:b},percentage:0,invisibleReason:"NOT_IN_VIEWPORT"}:this.$2(a,b,d,e)};e.$1=function(a,b,c){c===void 0&&(c=0);return this.$4(a,b,c).percentage};e.$5=function(a,b,c){a=this.$3(a,b,c);if(a===0)return d("PercentVisible").NO_VISIBLE;else if(a<50)return d("PercentVisible").VISIBLE_0_PCT;else if(a<100)return d("PercentVisible").VISIBLE_50_PCT;else return d("PercentVisible").VISIBLE_100_PCT};e.$6=function(a,b,c){c===void 0&&(c=0);var e=Math.max(b.y,c);b=Math.min(b.y+b.height,a.height);b=100*(b-e)/(a.height-c);if(b<50)return d("PercentVisible").VISIBLE_0_PCT;else if(b<100)return d("PercentVisible").VISIBLE_50_PCT;else return d("PercentVisible").VISIBLE_100_PCT};e.$7=function(a,b){var e=0,f=c("ge")("pagelet_bluebar");f&&f.offsetHeight&&(e=f.offsetHeight+f.offsetTop);if(this.config.should_log_viewport_duration){f=this.$6(a,b,e);switch(f){case d("PercentVisible").VISIBLE_0_PCT:case d("PercentVisible").VISIBLE_50_PCT:case d("PercentVisible").VISIBLE_100_PCT:this.emit("viewport_viewability",{tracker:this,id:this.getID(),token:this.getToken(),percentVisible:f});break;default:break}}f=this.$5(a,b,e);switch(f){case d("PercentVisible").VISIBLE_0_PCT:case d("PercentVisible").VISIBLE_50_PCT:case d("PercentVisible").VISIBLE_100_PCT:this.emit("viewability",{tracker:this,id:this.getID(),token:this.getToken(),percentVisible:f});break;default:this.emit("hidden",{id:this.getID(),token:this.getToken()});break}};e.$8=function(a,b){if(c("Style").get(this.element,"visibility")==="hidden"||c("Style").get(this.element,"opacity")==="0")return!1;var d=b.x,e=b.y,f=b.x+b.width;b=b.y+b.height;this.topLeftInViewport=this.topLeftInViewport||d>=0&&d<=a.width&&e>=0&&e<=a.height;this.bottomRightInViewport=this.bottomRightInViewport||f>=0&&f<=a.width&&b>=0&&b<=a.height;return this.topLeftInViewport&&this.bottomRightInViewport};e.$9=function(a,b){if(this.hasEmittedFullViewEvent)return;this.$8(a,b)&&(this.emit("full_view",{tracker:this,id:this.getID(),token:this.getToken(),fullViewType:1}),this.hasEmittedFullViewEvent=!0)};e.$10=function(a,d,e,f,g){g===void 0&&(g=!1);a=a>0;e=e;a&&c("Visibility").isHidden()&&(a=!1,e="PAGE_VISIBILITY_HIDDEN");a&&this.isHidden?(this.lastImpressedAt=Date.now(),this.lastEnterWithPercent=d,this.logViewabilityEventsForAudit(d,this.lastInvisibleReason,f,g),this.isHidden=!1,b("cr:1095627")&&b("cr:1095627").onItemEnterViewport(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element),b("cr:1095628")&&b("cr:1095628")(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element,"enter","blue")):!a&&!this.isHidden&&(this.isHidden=!0,this.lastInvisibleReason=e,this.lastHiddenCause="none",b("cr:1095627")&&b("cr:1095627").onItemExitViewport(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element),b("cr:1095628")&&b("cr:1095628")(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element,"exit","blue"))};e.onVisible=function(a){var b=this;a=this.isVisible;var e=c("getViewportDimensions")(),f=c("getElementPosition")(this.element),g=this.config.count_blue_bar_height?d("FBFeedImpressionTopMarginGetter").getTopMargin():0;g=this.$4(e,f,g,this.config.detect_occlusion||!1);var h=g.percentage,i=g.invisibleReason,j=g.rects;g=g.isOccluded;var k=h>this.config.pixel_in_percentage;this.config.log_viewability_events_for_infra_validation&&this.$10(k,h,i,j,g);var l=[];i=[];(this.config.skip_imp_if_no_images||this.config.check_images_before_log)&&(l=Array.from(this.element.querySelectorAll("img")),i=Array.from(this.element.getElementsByClassName("_7cqq")),d("ODS").bumpEntityKey(2966,"feed_ads","ViewableImpressionTracker.delayLogImpression.isFeedLoadedCheck."+(l.length===0)+"."+(i.length===0)));if(this.config.skip_imp_if_no_images&&l.length===0){this.handleLogNonViewableOnInvisible(a);this.isVisible=!1;return}this.emit("visible",{tracker:this,id:this.getID(),token:this.getToken(),percentInViewport:h});this.config.should_log_viewability_duration&&this.$7(e,f);this.$9(e,f);if(!k){this.$11();this.handleLogNonViewableOnInvisible(a);this.isVisible=!1;return}this.isLogged()?this.$12():this.$13();j=this.config.fam_delivery_integrity_enable_user_hide_ads_check_and_is_feed?d("FeedAdXoutEventTracker").checkIfHidden(this.element):!1;this.isVisible=!(c("AdImpressionLoggingConfig").blockInvisible&&c("Visibility").isHidden())&&!j;g=this.isVisible&&!a;this.isVisible||this.handleLogNonViewableOnInvisible(a);if((this.config.client_no_dedup?g:this.isVisible)&&!this.waitForLogged&&!this.waitForDelayLogged&&!this.isLogged()){i=function(){b.waitForLogged=!1;if(c("AdImpressionLoggingConfig").blockInvisible&&c("Visibility").isHidden())return;var a=b.getPercentInViewport();a=a>b.config.pixel_in_percentage;if(!a){b.$14();return}b.config.check_images_before_log&&(l.length===0&&d("ODS").bumpEntityKey(2966,"feed_ads","ViewableImpressionTracker.log_without_load."+b.config.trackable_identifier));if(c("GHLDelay").getEnabled()&&b.config.can_delay_log_impression===!0){b.waitForDelayLogged=!0;a=c("AdImpressionLoggingConfig").maxHiddenCheckDelay;a=a-b.config.duration_in_ms;a<0&&(a=0);b.delayedLoggingTimeout=setTimeout(b.delayLogImpression,a)}else b.logImpression(1,!1,{}),b.$12()};this.waitForLogged=!0;this.viewableTimeout=setTimeout(i,this.config.duration_in_ms)}};e.handleLogNonViewableOnInvisible=function(a){this.config.log_initial_nonviewable&&!this.isLogged()&&!this.isNonViewableLogged?this.logNonViewableImpression():!this.config.log_initial_nonviewable&&!this.isLogged()&&a&&this.logNonViewableImpression()};e.onHidden=function(a){var d=this;this.lastHiddenCause=a;this.isHidden||(this.isHidden=!0,this.lastInvisibleReason="NOT_IN_VIEWPORT",b("cr:1095627")&&b("cr:1095627").onItemExitViewport(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element),b("cr:1095628")&&b("cr:1095628")(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element,"exit","blue"));this.emit("hidden",{id:this.getID(),token:this.getToken()});a=this.isVisible;this.handleLogNonViewableOnInvisible(a);this.isVisible=!1;this.waitForLogged&&(this.waitForLogged=!1,clearTimeout(this.viewableTimeout));this.config.client_no_dedup&&this.config.subsequent_gap_in_ms===0&&this.config.client_track_subsequent_impression?this.reset():this.isLogged()&&!this.waitForSubsequent&&this.config.subsequent_gap_in_ms>=0&&this.config.client_track_subsequent_impression&&(this.waitForSubsequent=!0,this.clearSubsequentTimeout=setTimeout(function(){d.waitForSubsequent=!1,d.reset(),d.isVisible&&d.onVisible()},this.config.subsequent_gap_in_ms));this.$14()};e.onRemoved=function(){this.isVisible=!1};e.getToken=function(){return c("DataAttributeUtils").getDataAttribute(this.element,"data-xt")};e.logViewabilityEventsForAudit=function(a,e,f,g){var h=this,i=this.getToken(),k=Math.floor(Date.now()/1e3),l=this.$15(),m=c("FBImpressionValidationUtils").getFBFeedLocation(this.element),n=b("ScriptPath").getTopViewEndpoint(),o=j?j():null,p=c("getCentralImpressionTimeAfterRefresh")(),q=d("WebSession").getId(),r=c("uuid")(),s=this.config.is_rhc?c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE_RHC:c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE;c("CometMetricsChannel2ViewabilityFalcoEvent").logImmediately(function(){return{framework:s,event_trace_id:r,xt:i,cts:String(k),csp:String(l),me:n,vp:String(a),fbfeed_location:String(m),scroll_speed:String(o),time_from_load:String(p),sk:q,pre_rs:e,sub_imp:h.isSubsequentImp,last_hidden_cause:h.lastHiddenCause,rects:f,behind_popout:g}});this.isSubsequentImp=!0};e.logImpression=function(a,e,f){if(this.isLogged())return;var g=this.getToken(),h=Math.floor(Date.now()/1e3),i=this.$15(),j=Date.now()+"_"+(c("randomInt")(0,4294967295)+1);g={xt:g,isv:a,cts:h,csp:i,hba:e,etid:j,sender:"ViewableImpressionTracker"};this.config.should_log_endpoint_info&&(g.me=b("ScriptPath").getTopViewEndpoint());if(c("gkx")("940796")&&k){a=k.getItem(l);a==null&&(a=0);g.event_count=parseInt(a,10);k.setItem(l,g.event_count+1)}if(this.config.should_batch||this.config.vital_mode_for_ss||this.config.signal_mode_for_ss){g.transmission_channel="banzai";h=this.config.vital_mode_for_ss?babelHelpers["extends"]({},c("Banzai").VITAL):babelHelpers["extends"]({},null);h.signal=this.config.signal_mode_for_ss;g.event_trace_id=c("uuid")();this.logWithBanzai(g,h);this.logWithFalco(g)}else g.transmission_channel="iframe",this.logWithIFrame(Object.assign(g,f));if(c("gkx")("876709"))try{i=JSON.parse(c("DataAttributeUtils").getDataFt(this.element));e=i.page_id;j=i.top_level_post_id;a=i.fbfeed_location;e&&j&&d("ViewableSessionStore").onEventLogged("page_post_impression",j,a)}catch(a){d("ODS").bumpEntityKey(2966,"impression_logging_debug","viewable_session_validation_exception."+a.message)}};e.logNonViewableImpression=function(){if(this.config.nonviewableEnabled){var a=this.getToken();c("Banzai").post("xtrackable:nonviewable",{xt:a})}this.isNonViewableLogged=!0};e.isLogged=function(){return this.iframeLogged||this.banzaiLogged||this.falcoLogged};e.reset=function(){this.iframeLogged&&(this.iframeLogged=!1),this.iframe&&(c("DOM").remove(this.iframe),this.iframe=null),this.banzaiLogged&&(this.banzaiLogged=!1),this.falcoLogged&&(this.falcoLogged=!1),this.isNonViewableLogged=!1,this.isVisible=!1,this.waitForLogged=!1,this.waitForDelayLogged=!1,this.waitForSubsequent=!1};e.logWithFalco=function(a){var b=this;c("killswitch")("MSITE_STOP_IMPS_LOGGING_VIA_FALCO")||(this.falcoLogged=!0,c("MsiteViewableImpressionFalcoEvent").logImmediately(function(){return a}),this.config.log_viewability_events_for_infra_validation&&c("CometMetricsChannel2ViewabilityFalcoEvent").logImmediately(function(){return{framework:c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE_AFTER_DEDUP,xt:String(a.xt),isv:String(a.isv),cts:String(a.cts),csp:String(a.csp),hba:a.hba,etid:String(a.etid),sender:a.sender,event_count:String(a.eventCount),transmission_channel:a.transmission_channel,event_trace_id:a.event_trace_id,me:a.me,fbfeed_location:String(c("FBImpressionValidationUtils").getFBFeedLocation(b.element)),scroll_speed:j?String(j()):null,time_from_load:String(c("getCentralImpressionTimeAfterRefresh")()),sk:d("WebSession").getId()}}))};e.logWithBanzai=function(a,e){this.banzaiLogged=!0,d("BrowseClientEventLogger").maybeLogClientViewEvent(a),c("Banzai").post("xtrackable:clientview_batch",a,e),b("cr:1095628")&&b("cr:1095628")(c("ViewabilityFramework").VIEWABLE_TRACKER_BLUE,this.element,"log","blue")};e.logWithIFrame=function(a){this.iframeLogged=!0,this.config.is_instream_story?c("NonBlockingIFrame").loadIFrame(new(c("URI"))(this.config.impressionURL).addQueryData(a).toString()):(this.iframe=c("DOM").create("iframe",{src:new(c("URI"))(this.config.impressionURL).addQueryData(a).toString(),width:0,height:0,frameborder:0,scrolling:"no",className:"fbEmuTracking"}),this.iframe.setAttribute("aria-hidden","true"),c("DOM").appendContent(this.element,this.iframe))};e.$15=function(){var a=c("DataAttributeUtils").getDataAttribute(this.element,"data-dedupekey");if(a===null)return null;var b=this.$16();if(b===null||b.length===0)return null;var d=b.length;while(--d>=0){var e=c("DataAttributeUtils").getDataAttribute(b[d],"data-dedupekey");if(e!==null&&a===e)break}return d+1};e.$16=function(){var a=c("ge")("contentArea");if(a){var b="._5jmm";a=c("DOM").scry(a,b);return a.filter(function(a){return c("DataAttributeUtils").getDataAttribute(a,"data-dedupekey")})}else{c("gkx")("917")?b=c("ge")("m_news_feed_stream"):b=c("ge")("m_newsfeed_stream");return b===null?null:b.getElementsByTagName("article")}};e.$17=function(){return 0};e.$11=function(){this.$17()&&(c("Style").set(this.element,"background-color","#abab9a"),c("Style").set(this.element,"outline","3px solid #abab9a"))};e.$13=function(){this.$17()&&(c("Style").set(this.element,"background-color","#e4f70a"),c("Style").set(this.element,"outline","3px solid #e4f70a"))};e.$14=function(){this.$17()&&(c("Style").set(this.element,"background-color",null),c("Style").set(this.element,"outline",null))};e.$12=function(){this.$17()&&(c("Style").set(this.element,"background-color","#047515"),c("Style").set(this.element,"outline","3px solid #047515"))};return a}();c("mixInEventEmitter")(a,{visible:!0,hidden:!0,full_view:!0,viewability:!0,viewport_viewability:!0,viewability_debug:!0});e=a;g["default"]=e}),98);
__d("getContextualParent",["ge"],(function(a,b,c,d,e,f,g){function a(a,b){b===void 0&&(b=!1);var d=!1;a=a;do{if(a instanceof Element){var e=a.getAttribute("data-ownerid");if(e){a=c("ge")(e);d=!0;continue}}a=a.parentNode}while(b&&a&&!d);return a}g["default"]=a}),98);
__d("collectDataAttributes",["DataAttributeUtils","getContextualParent"],(function(a,b,c,d,e,f){var g="normal";function a(a,c,d){var e={},f=[],h=c.length,i;for(i=0;i<h;++i)e[c[i]]={},f.push("data-"+c[i]);if(d){e[g]={};for(i=0;i<(d||[]).length;++i)f.push(d[i])}d={tn:"","tn-debug":","};a=a;while(a){if(a.getAttribute)for(i=0;i<f.length;++i){var j=f[i],k=b("DataAttributeUtils").getDataAttribute(a,j);if(k){if(i>=h){e[g][j]===void 0&&(e[g][j]=k);continue}j=JSON.parse(k);for(var k in j)d[k]!==void 0?(e[c[i]][k]===void 0&&(e[c[i]][k]=[]),e[c[i]][k].push(j[k])):e[c[i]][k]===void 0&&(e[c[i]][k]=j[k])}}a=b("getContextualParent")(a)}for(var k in e)for(var j in d)e[k][j]!==void 0&&(e[k][j]=e[k][j].join(d[j]));return e}e.exports=a}),null);
__d("VisibilityTracking",["Banzai","BrowseClientEventLogger","DataAttributeUtils","ErrorUtils","ScriptPath","SubscriptionsHandler","Visibility","VisibilityTrackingHelper","collectDataAttributes","getElementPosition","gkx","pageID","throttle"],(function(a,b,c,d,e,f,g){var h="visibility_tracking",i="[data-vistracking]",j=500,k=50,l=50,m=50,n=50,o=0;a=function(){function a(a){var b=this;a=a||{};this.visibleElementInfo={};this.doNotForceExitOnUpdateVisible=!1;this.getDataFromConfig(a);c("Visibility").addListener(c("Visibility").VISIBLE,c("ErrorUtils").guard(function(){return b.fireEvent("browser")},"VisibilityTracking:visible",this));c("Visibility").addListener(c("Visibility").HIDDEN,c("ErrorUtils").guard(function(){return b.clearAllVisibleElements("browser")},"VisibilityTracking:hidden",this));c("ScriptPath").subscribe(c("ErrorUtils").guard(function(){return b.updateVisibleElements()},"VisibilityTracking:scriptPath",this));c("Banzai").subscribe(c("Banzai").SHUTDOWN,c("ErrorUtils").guard(function(){return b.onUnload()},"VisibilityTracking:banzaiShutdown",this));this.fireEventCallback=c("throttle").acrossTransitions(c("ErrorUtils").guard(function(a){return b.fireEvent(a)},"VisibilityTracking:fireEventCallback",this),this.timeout,this);this.listeners=new(c("SubscriptionsHandler"))();d("VisibilityTrackingHelper").getEventListeners(function(){return b.fireEventCallback()},a).forEach(function(a){b.listeners.addSubscriptions(a)});this.extraInit&&c("ErrorUtils").applyWithGuard(this.extraInit.bind(this))}var b=a.prototype;b.getDataFromConfig=function(a){this.config=a,this.root=a.root||document.documentElement,this.selector=a.selector||i,this.visibleEventCallBack=a.visibleEventCallBack||function(){},this.timeout=a.timeout!==void 0?a.timeout:j,this.minOffsetVisibleFromBottom=a.minOffsetVisibleFromBottom!==void 0?a.minOffsetVisibleFromBottom:k,this.minOffsetVisibleFromTop=a.minOffsetVisibleFromTop!==void 0?a.minOffsetVisibleFromTop:l,this.minOffsetVisibleFromLeft=a.minOffsetVisibleFromLeft!==void 0?a.minOffsetVisibleFromLeft:m,this.minOffsetVisibleFromRight=a.minOffsetVisibleFromRight!==void 0?a.minOffsetVisibleFromRight:n,this.handleAllHiddenEvents=a.handleAllHiddenEvents!==void 0?a.handleAllHiddenEvents:!1,this.handleAllVisibleEvents=a.handleAllVisibleEvents!==void 0?a.handleAllVisibleEvents:!1,this.cacheTrackedElements=a.cacheTrackedElements!==void 0?a.cacheTrackedElements:!1,this.addCauseToAllHiddenEvents=a.addCauseToAllHiddenEvents!=void 0?a.addCauseToAllHiddenEvents:!1,this.doNotForceExitOnUpdateVisible=a.doNotForceExitOnUpdateVisible!=void 0?a.doNotForceExitOnUpdateVisible:!1};b.getAllTrackedElements=function(){if(!this.allTrackedElements){this.allTrackedElements={};var a=[];this.config.is_xtrackable?a=c("DataAttributeUtils").getXTrackableElements():this.root&&this.root.querySelectorAll&&(a=this.root.querySelectorAll(this.selector));for(var b=0;b<a.length;b++){var d=this.getElementID(a[b]);this.allTrackedElements[d.toString()]=a[b]}}return this.allTrackedElements};b.refreshAllTrackedElements=function(){delete this.allTrackedElements;return this.getAllTrackedElements()};b.getDataToLog=function(a){a=Object.assign(c("collectDataAttributes")(a,["gt"]).gt,{client_time:Date.now()/1e3,time_spent_id:c("pageID"),script_path:c("ScriptPath").getScriptPath()});return a};b.getElementID=function(a){var b=a.$1;if(b)return b;a.$1=++o;return o};b.sendDataToLog=function(a){d("BrowseClientEventLogger").maybeLogVisiblityEvent(a),c("Banzai").post(h,a)};b.isInstreamAdStoryElement=function(a){return!1};b.fireEvent=function(a){a===void 0&&(a="default");var b=this.cacheTrackedElements?this.allTrackedElements:this.refreshAllTrackedElements();for(var c in b){var e=b[c],f=d("VisibilityTrackingHelper").getViewportInfo();f=this.isVisible(e,f);!f&&(c in this.visibleElementInfo||this.handleAllHiddenEvents)?this.handleEvent(e,{name:"hidden",cause:a}):f&&(!(c in this.visibleElementInfo)||this.handleAllVisibleEvents)&&this.handleEvent(e,{name:"visible",cause:a})}this.clearUntrackedVisibleElements()};b.isVisible=function(a,b){if(a==null)return!1;if(c("gkx")("820050")&&d("VisibilityTrackingHelper").isSnippetFlyoutVisible())return!1;a=c("getElementPosition")(a);return!!(a.x||a.y||a.width||a.height)&&a.y+a.height>=this.minOffsetVisibleFromTop&&a.y<=b.height-this.minOffsetVisibleFromBottom&&a.x+a.width>=this.minOffsetVisibleFromLeft&&a.x<=b.width-this.minOffsetVisibleFromRight};b.handleEvent=function(a,b){var d=this.getElementID(a).toString(),e=this.getDataToLog(a),f;if(b.name==="visible"){var g=Math.floor(Date.now()/1e3);f=c("pageID").concat(":",g.toString(),":",this.getElementID(a).toString());this.visibleElementInfo[d]={visibility_id:f,elem:a}}else if(b.name==="hidden"){d in this.visibleElementInfo&&(f=this.visibleElementInfo[d].visibility_id,delete this.visibleElementInfo[d]);if(b.cause==="browser"||this.doNotForceExitOnUpdateVisible&&b.cause==="updateVisible")return}this.sendDataToLog(Object.assign(e,{event:b.name,visibility_id:f}))};b.clearUntrackedVisibleElements=function(){var a=this.getAllTrackedElements();for(var b in this.visibleElementInfo)if(!(b in a)){var c=this.visibleElementInfo[b];c.elem&&this.handleEvent(c.elem,{name:"hidden",cause:"removed"})}};b.clearAllVisibleElements=function(a){a===void 0&&(a="default");var b=this.getAllTrackedElements();for(var c in b)c in this.visibleElementInfo&&this.handleEvent(b[c],{name:"hidden",cause:a});this.clearUntrackedVisibleElements()};b.updateVisibleElements=function(){this.addCauseToAllHiddenEvents?this.clearAllVisibleElements("updateVisible"):this.clearAllVisibleElements(),this.fireEvent()};b.refreshAndFireEvent=function(a){this.refreshAllTrackedElements(),this.fireEventCallback(a)};b.onUnload=function(){this.addCauseToAllHiddenEvents?this.clearAllVisibleElements("unload"):this.clearAllVisibleElements(),this.listeners&&(this.listeners.release(),this.listeners=null),this.extraCleanup&&c("ErrorUtils").applyWithGuard(this.extraCleanup.bind(this))};a.init=function(b){return new a(b)};return a}();g["default"]=a}),98);
__d("ViewableImpressionEventHandler",["DataAttributeUtils","FullViewLogger","ViewabilityDurationSegmentLogger","ViewableImpressionDurationLogger","ViewableImpressionHeatmapLogger","ViewableImpressionTracker","VisibilityTracking","pageID"],(function(a,b,c,d,e,f,g){"use strict";var h=1;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var d=b.prototype;d.extraInit=function(){this.$ViewableImpressionEventHandler1=new Map()};d.getDataFromConfig=function(b){a.prototype.getDataFromConfig.call(this,b),this.$ViewableImpressionEventHandler2=b.$ViewableImpressionEventHandler2,this.$ViewableImpressionEventHandler3=b.heatmapLoggingDurationMS,b.impressionURL=b.impressionURL!==void 0?b.impressionURL:"/xti.php",b.nonviewableEnabled=b.nonviewableEnabled!==void 0?b.nonviewableEnabled:!1};d.getImpressionTracking=function(a){var b=this.getElementID(a),d=this.$ViewableImpressionEventHandler1.get(b);if(!d){var e=babelHelpers["extends"]({},this.getConfigFromElement(a),this.config);d=new(c("ViewableImpressionTracker"))(b,a,e);this.$ViewableImpressionEventHandler1.set(b,d);e.log_impression_duration&&c("ViewableImpressionDurationLogger").logFromViewableImpressionTracker(d);this.$ViewableImpressionEventHandler2&&c("ViewableImpressionHeatmapLogger").logFromViewableImpressionTracker(d,this.$ViewableImpressionEventHandler3);e.should_log_full_views&&c("FullViewLogger").logFromViewableImpressionTracker(d);e.should_log_viewability_duration&&c("ViewabilityDurationSegmentLogger").logFromViewableImpressionTracker(d)}return d};d.handleEvent=function(a,b){var d=this.getImpressionTracking(a);if(!d)return;if(b.name==="visible"){var e=Math.floor(Date.now()/1e3);e=c("pageID").concat(":",e.toString(),":",this.getElementID(a).toString());d.onVisible(b);this.visibleElementInfo[d.getID()]||(this.visibleElementInfo[d.getID()]={visibility_id:e,elem:a})}else if(b.name==="hidden"){e=d.getConfig();b.cause==="default"||e.log_visibility_hidden_when_browser_inactive&&b.cause==="browser"||e.addCauseToAllHiddenEvents&&(b.cause==="updateVisible"||b.cause==="unload")?(d.onHidden(b.cause),delete this.visibleElementInfo[d.getID()]):b.cause==="removed"&&(d.onRemoved(),delete this.visibleElementInfo[d.getID()],this.$ViewableImpressionEventHandler1["delete"](d.getID()))}};d.isInstreamAdStoryElement=function(a){a=babelHelpers["extends"]({},this.getConfigFromElement(a),this.config);return!!a.is_instream_story};d.getConfigFromElement=function(a){return JSON.parse(c("DataAttributeUtils").getDataAttribute(a,"data-xt-vimp"))};d.getElementID=function(a){a.getAttribute("id")||a.setAttribute("id","xt_uniq_"+h++);return a.getAttribute("id")};return b}(c("VisibilityTracking"));g["default"]=a}),98);
__d("MViewableImpressionTracking",["ErrorUtils","MViewableImpressionConfig","Stratcom","ViewableImpressionEventHandler"],(function(a,b,c,d,e,f){var g;a={init:function(){b("ViewableImpressionEventHandler").instance===void 0&&(b("ViewableImpressionEventHandler").instance=new(b("ViewableImpressionEventHandler"))(b("MViewableImpressionConfig")),b("Stratcom").listen(["m:ajax:complete","m:feed:new-stories-loaded","m:more_item_automatic:items_loaded","m:onload","m-timeline-section-loader:complete","m-timeline-section-loader:init","m:profile:teaser-list:expanded","m:stories:card-hidden","m:stories:card-loaded","m:viewport:update-complete"],null,(g||(g=b("ErrorUtils"))).guard(function(){if(b("ViewableImpressionEventHandler").instance===void 0){b("Stratcom").removeCurrentListener();return}b("ViewableImpressionEventHandler").instance.refreshAndFireEvent()},"MViewableImpressionTracking")),b("Stratcom").listen("m:page:unload",null,g.guard(function(){delete b("ViewableImpressionEventHandler").instance,b("ViewableImpressionEventHandler").instance=void 0},"MViewableImpressionTracking")))}};e.exports=a}),null);
__d("MSnowflakeLink",["DOM","DataAttributeUtils","MLinkHack","MModalDialog","Stratcom","URI","destroyOnUnload"],(function(a,b,c,d,e,f){var g;a=function(){"use strict";function a(a){var c=this;this.$1=!1;this.$2=a.node;this.$3=a.permalink;this.$4=a.setToken;this.$5=a.targetPhoto;this.$6=b("DOM").listen(a.node,"click",null,this.onClick.bind(this));b("destroyOnUnload")(function(){return c.$6.remove()});this.$7()}var c=a.prototype;c.getFeedTrackingOwnerID=function(){var a=b("DataAttributeUtils").getClickTrackingParent(this.$2);return a&&a.id};c.getPermalinkURI=function(){return new(g||(g=b("URI")))(this.$3).addQueryData("photo_id",this.$5)};c.getModalDialogURI=function(){return new(g||(g=b("URI")))(this.$2.getAttribute("href")).addQueryData("cached_data",this.$1).addQueryData("ftid",this.getFeedTrackingOwnerID())};c.onClick=function(a){b("MLinkHack").remove(this.$2),b("MModalDialog").openWithPermalinkURI(this.getModalDialogURI().toString(),this.getPermalinkURI()),a.prevent()};c.$7=function(){var a=this;if(!this.$4){this.$1=!0;return}var c=b("Stratcom").listen("m:photosetstore:update",null,function(b){b=(b.getData()||{}).set_token;if(!c||b!=a.$4)return;a.$1=!0;c.remove();c=null});b("destroyOnUnload")(function(){return c&&c.remove()})};return a}();e.exports=a}),null);
__d("MShareAngoraAttachment",["Stratcom"],(function(a,b,c,d,e,f){var g=!1;a=function(a){if(g)return;g=!0;window.addEventListener("error",function(a){if(a.target.nodeName=="IMG"){for(a=a.target;a!=document.body&&!b("Stratcom").hasSigil(a,"shareAngoraAttachmentMedia");a=a.parentNode);a!=document.body&&(a.style.display="none")}},!0)};f.registerDeadImageListener=a}),null);
__d("XPlacesUpdateLocationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/places/location_update/",{json_location:{type:"String"},source:{type:"Enum",defaultValue:"msite_unknown",enumType:1}})}),null);
__d("MLocationPrompt",["DOM","MRequest","MTaggingCounter","Stratcom","WebStorage","XPlacesUpdateLocationController"],(function(a,b,c,d,e,f,g){var h=["latitude","longitude","accuracy","altitude","altitudeAccuracy","heading","speed"],i={enableHighAccuracy:!0,timeout:6e4,maximumAge:3e5},j=6e4;a=function(){a.init=function(b,c,d,e){return new a(b,c,d,e)};a.getCoords=function(){return a.coords};a.isLocationAvailable=function(){return a.locationAvailable};function a(b,e,f,g){var h=this;this.$2=function(){d("MTaggingCounter").logEvent("geo_panel_accept"),h.$1(!0)};this.$3=function(){a.locationAvailable=!1,d("MTaggingCounter").logEvent("geo_panel_deny"),d("DOM").hide(h.container),c("Stratcom").invoke("m:jewel-set:notifications-jewel:refresh-flyout"),c("Stratcom").invoke(a.STRATCOM_DENY)};this.$5=function(b){a.locationAvailable=!1;h.clearWatch();var e=c("WebStorage").getLocalStorage();e&&e.setItem(a.GEOLOCATION_KEY,"0");d("DOM").show(h.container);d("DOM").hide(h.question);d("DOM").hide(h.loading);d("DOM").show(h.errored);c("Stratcom").invoke("m:jewel-set:notifications-jewel:refresh-flyout");c("Stratcom").invoke(a.STRATCOM_FAIL,null,{error:b});d("MTaggingCounter").logEvent("geo_panel_fail")};this.$4=function(){if(!h.listeners)return;for(var a=0;a<h.listeners.length;a++)h.listeners[a].remove();h.listeners=[]};this.lastUpdateTime=0;this.container=b;this.question=e;this.loading=f;this.errored=g;b=c("WebStorage").getLocalStorage();b&&b.getItem(a.GEOLOCATION_KEY)==="1"?this.$1():(a.locationAvailable=!1,d("DOM").show(this.question),d("DOM").hide(this.loading),d("DOM").hide(this.errored),d("DOM").show(this.container),c("Stratcom").invoke("m:jewel-set:notifications-jewel:refresh-flyout"),d("MTaggingCounter").logEvent("geo_panel_load"));this.listeners=[c("Stratcom").listen("click","accept-location",this.$2.bind(this)),c("Stratcom").listen("click","deny-location",this.$3.bind(this)),c("Stratcom").listen("m:page:unload",null,this.$4.bind(this))]}var b=a.prototype;b.clearWatch=function(){if(!this.watchID)return;navigator.geolocation.clearWatch(this.watchID);this.watchID=null};b.$1=function(b){var e=this;a.locationAvailable=!0;var f=c("WebStorage").getLocalStorage();f&&f.setItem(a.GEOLOCATION_KEY,"1");d("DOM").show(this.container);d("DOM").hide(this.question);d("DOM").show(this.loading);d("DOM").hide(this.errored);c("Stratcom").invoke("m:jewel-set:notifications-jewel:refresh-flyout");var g=setTimeout(this.$5,i.timeout);this.watchID=navigator.geolocation.watchPosition(function(a){b&&d("MTaggingCounter").logEvent("geo_panel_success"),clearTimeout(g),e.$6(a)},function(a){b&&d("MTaggingCounter").logEvent("geo_panel_fail"),clearTimeout(g),e.$5(a)},i);c("Stratcom").invoke(a.STRATCOM_ACCEPT)};b.$6=function(b){a.locationAvailable=!0;if(b){var e={},f;for(var g=0;g<h.length;g++)f=h[g],b.coords[f]&&(e[f]=b.coords[f]);b.timestamp&&(e.timestamp=b.timestamp/1e3);this.$7(JSON.stringify(e));d("DOM").hide(this.container);a.coords=e;c("Stratcom").invoke("m:jewel-set:notifications-jewel:refresh-flyout");c("Stratcom").invoke(a.STRATCOM_UPDATE,null,{position:b})}};b.$7=function(a){var b=Date.now();if(b-this.lastUpdateTime>j){this.lastUpdateTime=b;b=c("XPlacesUpdateLocationController").getURIBuilder().setString("json_location",a).setEnum("source","msite_location_prompt").getURI();new(c("MRequest"))(b).setMethod("POST").send()}};return a}();Object.assign(a,{STRATCOM_ACCEPT:"MLocationPrompt/accept",STRATCOM_DENY:"MLocationPrompt/deny",STRATCOM_UPDATE:"MLocationPrompt/update",STRATCOM_FAIL:"MLocationPrompt/fail",GEOLOCATION_KEY:"authorizeGeolocation",locationAvailable:void 0});g["default"]=a}),98);
__d("MMoreItemAutomatic",["MLocationPrompt","MPageCache","MPageControllerPath","MRequest","MRequestGateway","MRequestTypes","MResponseData","MStopNGo","MURI","MViewport","Stratcom","Vector","setTimeout","throttle"],(function(a,b,c,d,e,f,g){a=function(){function a(b){var e=this;this.$26=function(){e.$5?e.$27():!e.$6&&!e.$18&&e.$28()};this.$27=function(){!e.$6?(e.$17=!0,e.isElementVisible()&&c("Stratcom").invoke("m:more_item_automatic:spinner_visible",e.$9,e.$10),!e.$18?e.$28():e.$29()):e.$25()};this.$30=function(){e.$6||(e.$17=!1)};this.$31=function(){!e.$18&&(e.$8||e.isElementVisible())&&(e.$32(),e.$8=!1)};this.$32=function(){var b=c("MLocationPrompt").getCoords();e.$21&&b&&(e.$4=new(c("MURI"))(e.$4).addQueryData("lat",b.latitude).addQueryData("long",b.longitude).toString());b=new(c("MRequest"))(new(c("MURI"))(e.$4).toString());e.$3?b.setType(d("MRequestTypes").INDEPENDENT):b.setType(d("MRequestTypes").DEPENDENT);b.setAutoProcess(!1);var f=[],g=!1,h=function(){!g&&f.length&&(g=!0,f.shift().process())};e.$19&&(b.setTimeout(c("MRequestGateway").ERROR_TIMEOUT),b.setFinalizeUponError(!1),b.listen("error",function(b,d){c("setTimeout")(function(){navigator.onLine&&(d.reset(),d.addData({is_retry:1}),d.sendAfterProcessing())},a.TRY_AGAIN_DELAY)}));b.listen("response",function(a){a=new(c("MResponseData"))(a);a.listen("complete",function(){g=!1,h()});if(a.isPagelet()){f.push(a);h();return}g=!0;e.$15=a;e.$17&&e.$29()});b.send();e.$18=!0};this.$4=b.href;this.$21=b.sendGeolocation;this.$16=b.proximity_pages||7;this.$9=b.logger_id;this.$10=b.logger_name;this.$8=b.load_first_immediately;this.$19=b.retryOnError;this.$2=b.addToCache;this.$3=b.alwaysProcess;this.$20=b.scrollPrefetchThrottleFreq||0;this.$5=b.insertWhileScrolling;this.$18=!1;this.$17=!0;this.$13=0;this.$12=!1;this.$6=!1;this.$22=0;this.$7=null;this.$11=null;this.$14=!1;this.$15=null;this.$1=b.additionalEvent;var f=document.getElementById(b.id);f?(this.$22=c("Vector").getPos(f).y,this.$11=f,this.$14=b.persist_on_reload,this.$23()):this.uninstall()}var b=a.prototype;b.isElementVisible=function(){if(!this.$24())return!1;var a=this.$11;if(a&&"getBoundingClientRect"in a){var b=a.getBoundingClientRect(),e=b.width/10,f=b.height/10,g=b.left,h=b.right,i=b.top;b=b.bottom;var j=!1;while(!j&&g<=h&&i<=b){g=Math.round(g+e);i=Math.round(i+f);var k=document.elementFromPoint(g,i);j=a.contains(k)}k=j}else{e=c("Vector").getPos(a).y;f=e+c("Vector").getDim(a).y;g=d("MViewport").getScrollTop();h=g+d("MViewport").getUseableHeight();k=e<=h&&f>=g}return k};b.$25=function(){var a=this.$11;a&&(this.$22-d("MViewport").getScrollTop()<0&&(c("Stratcom").invoke("m:more_item_automatic:items_visible",this.$9),this.uninstall()))};b.$23=function(){!this.$18&&(this.$8||this.isElementVisible())&&(this.$32(),this.$8=!1);this.$7=[];this.$20>0&&this.$7.push(c("Stratcom").listen(["m:page:render:complete","scroll"],null,c("throttle").withBlocking(this.$26,this.$20,this)));this.$5||this.$7.push(c("MStopNGo").listen("go",this.$27.bind(this)),c("MStopNGo").listen("stop",this.$30.bind(this)));var a=this.$1;if(a!=null){var b;(b=this.$7)==null?void 0:b.push(c("Stratcom").listen(a,null,this.$32.bind(this)))}this.$7.push(c("Stratcom").listen("m:ajax:complete",null,this.$31.bind(this)))};b.$33=function(){var a=this.$11;if(a){var b=document;b=b.documentElement;if(b)return b.contains(a)}return!1};b.uninstall=function(){while(this.$7&&this.$7.length)this.$7.pop().remove();this.$18=!1;this.$15=null;this.$11=null;this.$14=!1};b.withinProximity=function(){var a=this.$11;return!!a&&c("Vector").getPos(a).y-d("MViewport").getScrollTop()<d("MViewport").getUseableHeight()*(1+this.$16)};b.$29=function(){var a=this.$15;a&&(this.$33()&&(a.process(),this.$2&&c("MPageCache").addCachedIUIResponse(d("MPageControllerPath").getRequestPath(),a)),c("Stratcom").invoke("m:more_item_automatic:items_loaded",this.$9,this.$10),this.$6=!0)};b.$24=function(){var a=this.$11;return!a||!a.offsetHeight?!1:!0};b.$28=function(){(this.isElementVisible()||this.$24()&&d("MViewport").getScrollTop()>100&&this.withinProximity())&&this.$32()};b.getPersistOnReload=function(){return this.$14};return a}();a.TRY_AGAIN_DELAY=1500;g["default"]=a}),98);
__d("InitMMoreItemAutomatic",["MMoreItemAutomatic","Stratcom"],(function(a,b,c,d,e,f,g){var h;function a(a){h||(h={},c("Stratcom").listen("m:page:loading",null,function(a){for(var a in h)h[a].getPersistOnReload()||(h[a].uninstall(),delete h[a])}));var b=a.id;h[b]&&h[b].uninstall();h[b]=new(c("MMoreItemAutomatic"))(a)}g.main=a}),98);